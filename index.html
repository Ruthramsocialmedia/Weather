<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather â€” Meghalaya</title>
    <link href="https://fonts.cdnfonts.com/css/satoshi" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <style>
      /* ========== DESIGN SYSTEM ========== */
      :root {
        --primary: #0b0f19;
        --secondary: #1a2332;
        --accent: #6caa23;
        --accent-light: #8bc34a;
        --accent-dark: #4a7c1a;
        --text: #ffffff;
        --text-light: #e4e4e4;
        --text-muted: #b0b0b0;
        --card-bg: rgba(255, 255, 255, 0.08);
        --card-border: rgba(255, 255, 255, 0.1);
        --transition: all 0.3s ease;
        --border-radius: 16px;
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        --glass-bg: rgba(255, 255, 255, 0.05);
        --glass-border: rgba(255, 255, 255, 0.1);
        --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Satoshi", sans-serif;
      }

      body {
        background: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--secondary) 100%
        );
        color: var(--text);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 1rem;
        position: relative;
        overflow: hidden;
      }

      /* Background with mountain imagery */
      body::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(
            circle at 20% 80%,
            rgba(108, 170, 35, 0.05) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 20%,
            rgba(26, 35, 50, 0.3) 0%,
            transparent 50%
          ),
          url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800" opacity="0.03"><path fill="%23ffffff" d="M0,800 L200,600 L400,700 L600,500 L800,600 L1000,400 L1200,500 L1200,800 L0,800 Z"/></svg>');
        background-size: cover;
        z-index: -1;
      }

      /* Main container */
      .weather-app {
        width: 100%;
        max-width: 70%;
        max-height: 90vh;
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: var(--border-radius);
        box-shadow: var(--glass-shadow);
        overflow: hidden;
        position: relative;
        display: flex;
        flex-direction: column;
      }

      /* Header with city selector */
      .weather-header {
        padding: 1.5rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-shrink: 0;
      }

      .app-title {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--text);
      }

      .app-title i {
        color: var(--accent);
        margin-right: 0.5rem;
      }

      .city-selector {
        position: relative;
        min-width: 160px;
      }

      .city-dropdown {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 12px;
        color: var(--text);
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
        cursor: pointer;
        transition: var(--transition);
        appearance: none;
        padding-right: 2.5rem;
        width: 100%;
      }

      /* Style dropdown options */
      .city-dropdown option {
        background: var(--secondary);
        color: var(--text);
        padding: 0.5rem;
        border: none;
      }

      .city-dropdown:hover {
        background: rgba(255, 255, 255, 0.15);
      }

      .city-selector::after {
        content: "\f078";
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        position: absolute;
        right: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--accent);
        pointer-events: none;
      }

      /* Content area with controlled scrolling */
      .weather-content {
        flex: 1;
        overflow-y: auto;
        padding: 0;
        display: flex;
        flex-direction: column;
      }

      /* Current weather display */
      .current-weather {
        padding: 2rem 1.5rem 1.5rem;
        text-align: center;
        position: relative;
        flex-shrink: 0;
      }

      .weather-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
        color: var(--accent);
        filter: drop-shadow(0 0 10px rgba(108, 170, 35, 0.3));
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .temperature {
        font-size: 3.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        line-height: 1;
      }

      .weather-condition {
        font-size: 1.2rem;
        color: var(--text-light);
        margin-bottom: 1.5rem;
      }

      .location {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        margin-bottom: 2rem;
        color: var(--text-muted);
      }

      .location i {
        color: var(--accent);
      }

      /* Weather details grid */
      .weather-details {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-bottom: 2rem;
      }

      .detail-card {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        padding: 1rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        transition: var(--transition);
        min-height: 90px;
      }

      .detail-card:hover {
        background: rgba(255, 255, 255, 0.08);
        transform: translateY(-2px);
      }

      .detail-icon {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
        color: var(--accent);
        height: 30px;
        display: flex;
        align-items: center;
      }

      .detail-value {
        font-size: 1.2rem;
        font-weight: 700;
        margin-bottom: 0.25rem;
        line-height: 1.2;
      }

      .detail-label {
        font-size: 0.8rem;
        color: var(--text-muted);
        line-height: 1.2;
      }

      /* Map container */
      .map-container {
        padding: 0 1.5rem 1.5rem;
        flex-shrink: 0;
      }

      .map-title {
        font-size: 1rem;
        margin-bottom: 0.75rem;
        color: var(--text-light);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .map-title i {
        color: var(--accent);
      }

      .map-frame {
        height: 180px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .map-frame iframe {
        width: 100%;
        height: 100%;
        border: none;
      }

      .map-placeholder {
        height: 180px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: var(--text-muted);
        border: 1px dashed rgba(255, 255, 255, 0.2);
        text-align: center;
        padding: 1rem;
      }

      .map-placeholder i {
        font-size: 2rem;
        margin-bottom: 0.5rem;
        color: var(--accent);
      }

      /* Loading animation */
      .loading {
        display: none;
        text-align: center;
        padding: 2rem;
        flex-shrink: 0;
      }

      .loading-spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-left: 4px solid var(--accent);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 1rem;
      }

      .error-message {
        background: rgba(220, 53, 69, 0.1);
        border: 1px solid rgba(220, 53, 69, 0.3);
        border-radius: 8px;
        padding: 1rem;
        margin: 1rem;
        text-align: center;
        color: #ff6b6b;
        display: none;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Custom scrollbar */
      .weather-content::-webkit-scrollbar {
        width: 6px;
      }

      .weather-content::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 3px;
      }

      .weather-content::-webkit-scrollbar-thumb {
        background: var(--accent);
        border-radius: 3px;
      }

      .weather-content::-webkit-scrollbar-thumb:hover {
        background: var(--accent-light);
      }

      /* Responsive adjustments */
      @media (max-width: 480px) {
        .weather-header {
          flex-direction: column;
          gap: 1rem;
          align-items: flex-start;
        }

        .city-selector {
          width: 100%;
        }

        .city-dropdown {
          width: 100%;
        }

        .weather-details {
          gap: 0.75rem;
        }

        .detail-card {
          padding: 0.75rem;
          min-height: 85px;
        }

        .temperature {
          font-size: 3rem;
        }

        .weather-icon {
          font-size: 3.5rem;
          height: 70px;
        }
      }

      @media (max-height: 700px) {
        .current-weather {
          padding: 1.5rem 1.5rem 1rem;
        }

        .weather-icon {
          font-size: 3rem;
          height: 60px;
          margin-bottom: 0.75rem;
        }

        .temperature {
          font-size: 2.5rem;
        }

        .weather-condition {
          font-size: 1rem;
          margin-bottom: 1rem;
        }

        .location {
          margin-bottom: 1.5rem;
        }

        .weather-details {
          margin-bottom: 1.5rem;
        }

        .detail-card {
          min-height: 80px;
          padding: 0.75rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="weather-app">
      <div class="weather-header">
        <div class="app-title">
          <i class="fas fa-cloud-sun"></i>
          Weather â€” Meghalaya
        </div>
        <div class="city-selector">
          <select class="city-dropdown" id="citySelect">
            <option value="Shillong">Shillong</option>
            <option value="Cherrapunji">Cherrapunji</option>
            <option value="Tura">Tura</option>
            <option value="Nongpoh">Nongpoh</option>
            <option value="Mairang">Mairang</option>
            <option value="Baghmara">Baghmara</option>
            <option value="Williamnagar">Williamnagar</option>
          </select>
        </div>
      </div>

      <div class="weather-content">
        <div class="error-message" id="errorMessage">
          <i class="fas fa-exclamation-triangle"></i>
          <div>Unable to load weather data. Using demo data instead.</div>
        </div>

        <div class="current-weather">
          <div class="weather-icon">
            <i class="fas fa-cloud-sun" id="weatherIcon"></i>
          </div>
          <div class="temperature" id="temperature">22Â°C</div>
          <div class="weather-condition" id="weatherCondition">
            Partly Cloudy
          </div>
          <div class="location">
            <i class="fas fa-location-dot"></i>
            <span id="locationName">Shillong, Meghalaya</span>
          </div>

          <div class="weather-details">
            <div class="detail-card">
              <div class="detail-icon">
                <i class="fas fa-wind"></i>
              </div>
              <div class="detail-value" id="windSpeed">5 km/h</div>
              <div class="detail-label">Wind Speed</div>
            </div>
            <div class="detail-card">
              <div class="detail-icon">
                <i class="fas fa-droplet"></i>
              </div>
              <div class="detail-value" id="humidity">65%</div>
              <div class="detail-label">Humidity</div>
            </div>
            <div class="detail-card">
              <div class="detail-icon">
                <i class="fas fa-temperature-half"></i>
              </div>
              <div class="detail-value" id="feelsLike">23Â°C</div>
              <div class="detail-label">Feels Like</div>
            </div>
            <div class="detail-card">
              <div class="detail-icon">
                <i class="fas fa-gauge-high"></i>
              </div>
              <div class="detail-value" id="pressure">1013 hPa</div>
              <div class="detail-label">Pressure</div>
            </div>
          </div>
        </div>

        <div class="map-container">
          <div class="map-title">
            <i class="fas fa-map-location-dot"></i>
            Location Map
          </div>
          <div class="map-frame" id="mapFrame">
            <!-- Map iframe will be inserted here -->
          </div>
        </div>

        <div class="loading" id="loadingIndicator">
          <div class="loading-spinner"></div>
          <div>Loading weather data...</div>
        </div>
      </div>
    </div>

    <script>
      // ========== CONFIGURATION ==========
      // ADD YOUR OPENWEATHERMAP API KEY HERE
      const OPENWEATHER_API_KEY = "7452af76a2793bc774b1e57b5c07f752"; // Replace with your actual API key

      // Comprehensive city coordinates for Meghalaya
      const cityCoordinates = {
        Shillong: { lat: 25.5788, lng: 91.8933 },
        Cherrapunji: { lat: 25.2711, lng: 91.7356 },
        Tura: { lat: 25.5144, lng: 90.2022 },
        Nongpoh: { lat: 25.9, lng: 91.88 },
        Mairang: { lat: 25.56, lng: 91.64 },
        Baghmara: { lat: 25.19, lng: 90.65 },
        Williamnagar: { lat: 25.3, lng: 89.85 },
      };

      // Weather icons mapping
      const weatherIcons = {
        clear: "fas fa-sun",
        clouds: "fas fa-cloud",
        rain: "fas fa-cloud-rain",
        drizzle: "fas fa-cloud-drizzle",
        thunderstorm: "fas fa-bolt",
        snow: "fas fa-snowflake",
        mist: "fas fa-smog",
        fog: "fas fa-smog",
        haze: "fas fa-smog",
        default: "fas fa-cloud-sun",
      };

      // DOM elements
      const citySelect = document.getElementById("citySelect");
      const temperature = document.getElementById("temperature");
      const weatherCondition = document.getElementById("weatherCondition");
      const locationName = document.getElementById("locationName");
      const windSpeed = document.getElementById("windSpeed");
      const humidity = document.getElementById("humidity");
      const feelsLike = document.getElementById("feelsLike");
      const pressure = document.getElementById("pressure");
      const weatherIcon = document.getElementById("weatherIcon");
      const loadingIndicator = document.getElementById("loadingIndicator");
      const mapFrame = document.getElementById("mapFrame");
      const errorMessage = document.getElementById("errorMessage");

      // Function to generate OpenStreetMap iframe
      function generateMapIframe(city) {
        const coords = cityCoordinates[city];
        if (!coords) return "";

        return `
        <iframe 
          src="https://www.openstreetmap.org/export/embed.html?bbox=${
            coords.lng - 0.1
          }%2C${coords.lat - 0.1}%2C${coords.lng + 0.1}%2C${
          coords.lat + 0.1
        }&layer=mapnik&marker=${coords.lat}%2C${coords.lng}"
          width="100%" 
          height="100%" 
          style="border: none;"
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
          title="${city} Location Map"
        >
        </iframe>
      `;
      }

      // Mock data as fallback
      function getMockData(city) {
        const mockData = {
          Shillong: {
            temp: 22,
            condition: "Clouds",
            humidity: 65,
            wind: 5,
            feels_like: 23,
            pressure: 1013,
          },
          Cherrapunji: {
            temp: 18,
            condition: "Rain",
            humidity: 85,
            wind: 8,
            feels_like: 17,
            pressure: 1010,
          },
          Tura: {
            temp: 26,
            condition: "Clear",
            humidity: 60,
            wind: 4,
            feels_like: 27,
            pressure: 1012,
          },
          Nongpoh: {
            temp: 24,
            condition: "Clouds",
            humidity: 70,
            wind: 6,
            feels_like: 25,
            pressure: 1011,
          },
          Mairang: {
            temp: 21,
            condition: "Mist",
            humidity: 75,
            wind: 3,
            feels_like: 22,
            pressure: 1011,
          },
          Baghmara: {
            temp: 25,
            condition: "Clear",
            humidity: 55,
            wind: 5,
            feels_like: 26,
            pressure: 1012,
          },
          Williamnagar: {
            temp: 27,
            condition: "Clear",
            humidity: 50,
            wind: 4,
            feels_like: 28,
            pressure: 1013,
          },
        };

        return mockData[city] || mockData["Shillong"];
      }

      // Get weather data from OpenWeatherMap API
      async function getWeatherData(city) {
        // If no API key is set, use mock data
        if (
          OPENWEATHER_API_KEY === "7452af76a2793bc774b1e57b5c07f752" ||
          !OPENWEATHER_API_KEY
        ) {
          console.warn(
            "Using mock data - Please add your OpenWeatherMap API key"
          );
          errorMessage.style.display = "block";
          return getMockData(city);
        }

        const coords = cityCoordinates[city];

        try {
          const response = await fetch(
            `https://api.openweathermap.org/data/2.5/weather?lat=${coords.lat}&lon=${coords.lng}&appid=${OPENWEATHER_API_KEY}&units=metric`
          );

          if (!response.ok) {
            throw new Error(`API Error: ${response.status}`);
          }

          const data = await response.json();

          // Hide error message if previously shown
          errorMessage.style.display = "none";

          return {
            temp: Math.round(data.main.temp),
            condition: data.weather[0].main,
            humidity: data.main.humidity,
            wind: Math.round(data.wind.speed * 3.6), // Convert m/s to km/h
            feels_like: Math.round(data.main.feels_like),
            pressure: data.main.pressure,
          };
        } catch (error) {
          console.error("Error fetching weather data:", error);
          errorMessage.style.display = "block";
          // Fallback to mock data if API fails
          return getMockData(city);
        }
      }

      // Update weather display
      async function updateWeather(city) {
        // Show loading indicator
        loadingIndicator.style.display = "block";

        try {
          const weatherData = await getWeatherData(city);

          // Update weather information
          temperature.textContent = `${weatherData.temp}Â°C`;
          weatherCondition.textContent = weatherData.condition;
          locationName.textContent = `${city}, Meghalaya`;
          windSpeed.textContent = `${weatherData.wind} km/h`;
          humidity.textContent = `${weatherData.humidity}%`;
          feelsLike.textContent = `${weatherData.feels_like}Â°C`;
          pressure.textContent = `${weatherData.pressure} hPa`;

          // Update weather icon
          const condition = weatherData.condition.toLowerCase();
          let iconClass = weatherIcons.default;

          if (condition.includes("clear")) iconClass = weatherIcons.clear;
          else if (condition.includes("cloud")) iconClass = weatherIcons.clouds;
          else if (condition.includes("rain")) iconClass = weatherIcons.rain;
          else if (condition.includes("drizzle"))
            iconClass = weatherIcons.drizzle;
          else if (condition.includes("thunder"))
            iconClass = weatherIcons.thunderstorm;
          else if (condition.includes("snow")) iconClass = weatherIcons.snow;
          else if (
            condition.includes("mist") ||
            condition.includes("fog") ||
            condition.includes("haze")
          ) {
            iconClass = weatherIcons.mist;
          }

          weatherIcon.className = iconClass;

          // Update map with actual iframe
          const mapHTML = generateMapIframe(city);
          if (mapHTML) {
            mapFrame.innerHTML = mapHTML;
          } else {
            mapFrame.innerHTML = `
            <div class="map-placeholder">
              <i class="fas fa-map"></i>
              <div>Map unavailable for ${city}</div>
            </div>
          `;
          }
        } catch (error) {
          console.error("Error updating weather:", error);
          errorMessage.style.display = "block";
        } finally {
          // Hide loading indicator
          loadingIndicator.style.display = "none";
        }
      }

      // Event listener for city selection
      citySelect.addEventListener("change", function () {
        updateWeather(this.value);
      });

      // Initialize with default city
      updateWeather("Shillong");
    </script>
  </body>
</html>
